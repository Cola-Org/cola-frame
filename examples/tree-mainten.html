<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css"
		  href="../resources/cola-ui/semantic.min.css">
	<link rel="stylesheet" type="text/css" href="../resources/cola-ui/cola.min.css">
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.2.3.js"></script>
	<script type="text/javascript" src="../resources/cola-ui/3rd.min.js"></script>
	<script type="text/javascript" src="../resources/cola-ui/semantic.min.js"></script>
	<script type="text/javascript" src="../resources/cola-ui/cola.js"></script>
	<style>
		.current > .tree.node .node-operation {
			display: inline-block;
		}

		.node-operation {
			display: none;
			float: right;
			padding-right: 0.5em;
		}

		.node-operation i {
			margin-right: 0.5em;
		}

	</style>
</head>
<body>

<div style="height:100%" class="h-box">
	<div class="flex-box">
		<div style="padding: 2px">
			<div c-widget="Panel; caption:行政区域; height:100%">
				<div class="content">
					<div id="tree">
						<template name="node-default">
							<div><span c-bind="node.name"></span>

								<div class="node-operation">
									<i c-onclick="add()" class="link icon plus"></i>
									<i c-onclick="remove(node)" class="link icon trash outline"></i>
								</div>
							</div>
						</template>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="flex-box">
		<div style="padding: 2px">
			<div c-widget="Panel; caption:详细信息; height:100%">
				<div class="content">
					<div class="ui form">
						<div class="inline field">
							<label>行政区域名称</label>

							<div c-widget="input; bind:currentEditItem.name; postOnInput:true"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</body>

<script>
	cola(function (model) {
		model.set("node", {
			nodes: [
				{
					name: "中国",
					nodes: [
						{
							name: "上海",
							nodes: [
								{
									name: "浦东新区"
								},
								{
									name: "杨浦"
								},
								{
									name: "松江"
								}, {
									name: "徐汇区"
								}
							]
						}, {
							name: "内蒙古",
							nodes: [
								{
									name: "兴安盟"
								}, {
									name: "通辽"
								}, {
									name: "锡林郭勒"
								}, {
									name: "呼伦贝尔"
								}, {
									name: "赤峰"
								}
							]
						}
					]
				},{
					name: "11"
				}
			]
		});

		model.action({
			remove: function (node) {
				node.remove();
				event && event.stopPropagation();
			},
			add: function () {
				var currentEditItem = model.get("currentEditItem");
				var nodes = currentEditItem.get("nodes","sync");
				if (!nodes) {
					currentEditItem.set("nodes", []);
					nodes = currentEditItem.get("nodes")
				}
				var entity = nodes.insert({
					name: "New Node"
				});
				var tree = cola.widget("tree");
				var currentNode = tree.findNode(currentEditItem);
				tree.expand(currentNode);
				tree.set("currentItem", entity);
				event && event.stopPropagation();
			}
		});

		model.widgetConfig({
			tree: {
				$type: "tree",
				autoCollapse: false,
				autoExpand: true,
				currentItemAlias:"currentEditItem",
				highlightCurrentItem: true,
				bind: {
					recursive: true,
					expandedProperty: "expanded",
					textProperty: "name",
					expression: "node in node.nodes"
				}
			}
		});
	});
</script>
</html>